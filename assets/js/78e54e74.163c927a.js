"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[552],{8443:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"lens","title":"Lens","description":"A Lens is a conceptual piece of code packaged as a FHIR Library resource that encodes clinical or context-specific knowledge, applying transformation rules based on patient data.","source":"@site/ref/lens.md","sourceDirName":".","slug":"/lens","permalink":"/reference/lens","draft":false,"unlisted":false,"editUrl":"https://github.com/gravitate-health/gravitate-health.github.io/tree/main/ref/lens.md","tags":[{"inline":true,"label":"focusing","permalink":"/reference/tags/focusing"},{"inline":true,"label":"lens","permalink":"/reference/tags/lens"},{"inline":true,"label":"adaptation-logic","permalink":"/reference/tags/adaptation-logic"},{"inline":true,"label":"fhir-library","permalink":"/reference/tags/fhir-library"}],"version":"current","sidebarPosition":35,"frontMatter":{"sidebar_position":35,"title":"Lens","tags":["focusing","lens","adaptation-logic","fhir-library"]},"sidebar":"tutorialSidebar","previous":{"title":"p(ePI) - Preprocessed ePI","permalink":"/reference/p-epi"},"next":{"title":"LEE (Lens Execution Environment)","permalink":"/reference/lee"}}');var s=i(4848),l=i(8453);const t={sidebar_position:35,title:"Lens",tags:["focusing","lens","adaptation-logic","fhir-library"]},c="Lens",o={},a=[{value:"Purpose",id:"purpose",level:2},{value:"Packaging",id:"packaging",level:2},{value:"FHIR Library Resource",id:"fhir-library-resource",level:3},{value:"Creation Tool",id:"creation-tool",level:3},{value:"Execution Inputs",id:"execution-inputs",level:2},{value:"Lens Operations",id:"lens-operations",level:2},{value:"Regulatory Constraints",id:"regulatory-constraints",level:2},{value:"Performance Requirements",id:"performance-requirements",level:2},{value:"Client-Side Execution",id:"client-side-execution",level:3},{value:"Server-Side Execution",id:"server-side-execution",level:3},{value:"Design Principle",id:"design-principle",level:3},{value:"Lens Types",id:"lens-types",level:2},{value:"Related Concepts",id:"related-concepts",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"lens",children:"Lens"})}),"\n",(0,s.jsxs)(n.p,{children:["A ",(0,s.jsx)(n.strong,{children:"Lens"})," is a conceptual piece of code packaged as a FHIR ",(0,s.jsx)(n.code,{children:"Library"})," resource that encodes clinical or context-specific knowledge, applying transformation rules based on patient data."]}),"\n",(0,s.jsx)(n.h2,{id:"purpose",children:"Purpose"}),"\n",(0,s.jsxs)(n.p,{children:["Lenses determine how ",(0,s.jsx)(n.a,{href:"/reference/epi",children:"ePI"})," content should be adapted for individual patients by:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Highlighting relevant sections"}),"\n",(0,s.jsx)(n.li,{children:"Collapsing irrelevant sections"}),"\n",(0,s.jsx)(n.li,{children:"Adding supplementary content"}),"\n",(0,s.jsx)(n.li,{children:"Enriching with interactive elements"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"packaging",children:"Packaging"}),"\n",(0,s.jsx)(n.h3,{id:"fhir-library-resource",children:"FHIR Library Resource"}),"\n",(0,s.jsxs)(n.p,{children:["Lenses follow the ",(0,s.jsx)(n.a,{href:"https://build.fhir.org/ig/hl7-eu/gravitate-health/StructureDefinition-lens.html",children:"Lens Profile"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"JavaScript code encoded in Base64 (UTF-8)"}),"\n",(0,s.jsxs)(n.li,{children:["Stored as ",(0,s.jsx)(n.code,{children:"Library.content.data"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/reference/lee",children:"LEE"})," decodes from Base64 \u2192 UTF-8 before execution"]}),"\n",(0,s.jsx)(n.li,{children:"Contains metadata (author, version, purpose)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"creation-tool",children:"Creation Tool"}),"\n",(0,s.jsxs)(n.p,{children:["Packaged using the ",(0,s.jsx)(n.a,{href:"https://github.com/Gravitate-Health/lens-tool-bundler",children:"FHIR Lens bundler"})," tool."]}),"\n",(0,s.jsx)(n.h2,{id:"execution-inputs",children:"Execution Inputs"}),"\n",(0,s.jsxs)(n.p,{children:["Lenses receive three inputs from ",(0,s.jsx)(n.a,{href:"/reference/lee",children:"LEE"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/reference/p-epi",children:"p(ePI)"})}),": Semantically annotated ePI"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/reference/ips",children:"IPS"})}),": Patient clinical data"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/reference/persona-vector",children:"PV"})}),": User context and preferences"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"lens-operations",children:"Lens Operations"}),"\n",(0,s.jsxs)(n.p,{children:["Lenses code is a JavaScript module that implements at least the ",(0,s.jsx)(n.code,{children:"enhance()"})," function, which applies transformation rules to the ",(0,s.jsx)(n.a,{href:"/reference/p-epi",children:"p(ePI)"})," based on the ",(0,s.jsx)(n.a,{href:"/reference/ips",children:"IPS"})," and ",(0,s.jsx)(n.a,{href:"/reference/persona-vector",children:"PV"}),", and returns the updated ",(0,s.jsx)(n.code,{children:"html"})," code representing the whole composition of the ePI.\nLenses can also implement an optional ",(0,s.jsx)(n.code,{children:"explanation()"})," function to provide reasoning behind their decisions.\nThe input elements (",(0,s.jsx)(n.code,{children:"epi"}),", ",(0,s.jsx)(n.code,{children:"ips"}),", ",(0,s.jsx)(n.code,{children:"pv"})," and ",(0,s.jsx)(n.code,{children:"html"})," code to process), are injected in to the lens object, so the lens can access them directly from its called functions, any modifications to these attributes will be descarted."]}),"\n",(0,s.jsx)(n.h2,{id:"regulatory-constraints",children:"Regulatory Constraints"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Critical Limitation"}),": Lenses ",(0,s.jsx)(n.strong,{children:"cannot"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Remove original ",(0,s.jsx)(n.a,{href:"/reference/epi",children:"ePI"})," content"]}),"\n",(0,s.jsx)(n.li,{children:"Change approved text"}),"\n",(0,s.jsx)(n.li,{children:"Delete HTML elements"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"They can only:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Modify CSS classes for visual presentation"}),"\n",(0,s.jsx)(n.li,{children:"Add supplementary HTML elements"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"performance-requirements",children:"Performance Requirements"}),"\n",(0,s.jsx)(n.h3,{id:"client-side-execution",children:"Client-Side Execution"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Must run efficiently on patient phones"}),"\n",(0,s.jsx)(n.li,{children:"Lightweight algorithms only"}),"\n",(0,s.jsx)(n.li,{children:"No heavy computation"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"server-side-execution",children:"Server-Side Execution"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Must scale for many concurrent users"}),"\n",(0,s.jsx)(n.li,{children:"Fast response times required"}),"\n",(0,s.jsx)(n.li,{children:"Ephemeral (not cached)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"design-principle",children:"Design Principle"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["Rely on ",(0,s.jsx)(n.a,{href:"/reference/preprocessor",children:"Preprocessors"})," for heavy computation"]})," (NLP, semantic analysis). Lenses execute lightweight logic based on preprocessor annotations."]}),"\n",(0,s.jsx)(n.h2,{id:"lens-types",children:"Lens Types"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Clinical Lenses"}),": Based on medical conditions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Demographic Lenses"}),": Age, gender-specific"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Preference Lenses"}),": Language, literacy level"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Summary Lenses"}),": Provide condensed views"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Multimedia Lenses"}),": Add rich media content"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"related-concepts",children:"Related Concepts"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/reference/lee",children:"LEE"})," - Execution environment"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/reference/p-epi",children:"p(ePI)"})," - Input content"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/reference/f-epi",children:"f(ePI)"})," - Output result"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/reference/ips",children:"IPS"})," - Patient data input"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/reference/persona-vector",children:"Persona Vector"})," - Context input"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/reference/attention-modification",children:"Attention Modification"})," - Visual changes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/reference/focusing",children:"Focusing"})," - Overall process"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>c});var r=i(6540);const s={},l=r.createContext(s);function t(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);