<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorial-Preprocessor/Introduction" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Introduction | Gravitate Health | Developer Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://gravitate-health.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://gravitate-health.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://gravitate-health.github.io/docs/tutorial-Preprocessor/Introduction"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Introduction | Gravitate Health | Developer Documentation"><meta data-rh="true" name="description" content="This document provides essential guidance for developers creating Preprocessor services within the Federated Open-Source Platform and Services (FOSPS) environment, particularly focusing on the annotation process for Electronic Product Information (ePI)."><meta data-rh="true" property="og:description" content="This document provides essential guidance for developers creating Preprocessor services within the Federated Open-Source Platform and Services (FOSPS) environment, particularly focusing on the annotation process for Electronic Product Information (ePI)."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://gravitate-health.github.io/docs/tutorial-Preprocessor/Introduction"><link data-rh="true" rel="alternate" href="https://gravitate-health.github.io/docs/tutorial-Preprocessor/Introduction" hreflang="en"><link data-rh="true" rel="alternate" href="https://gravitate-health.github.io/docs/tutorial-Preprocessor/Introduction" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.90d02428.css">
<script src="/assets/js/runtime~main.fbded316.js" defer="defer"></script>
<script src="/assets/js/main.43b6078d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Graviatate-Health" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Graviatate-Health" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Gravitate-Health FOSPS</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/reference/intro">Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/gravitate-health" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introducing FOSPS: Your Gateway to Innovative Digital Health Solutions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tutorial---connector">Tutorial - Connector</a><button aria-label="Expand sidebar category &#x27;Tutorial - Connector&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/tutorial---preprocessor">Tutorial - Preprocessor</a><button aria-label="Collapse sidebar category &#x27;Tutorial - Preprocessor&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tutorial-Preprocessor/Introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-Preprocessor/Develop a Basic Preprocessor">Develop a Basic Preprocessor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-Preprocessor/Basic Annotation">Basic ePI Annotation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-Preprocessor/Deploying your Preprocessor">Deploying your Preprocessor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-Preprocessor/Testing your Preprocessor">Testing your Preprocessor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-Preprocessor/Examples">Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-Preprocessor/Implementation Strategies">Implementation Strategies</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tutorial---lens">Tutorial - Lens</a><button aria-label="Expand sidebar category &#x27;Tutorial - Lens&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/tutorial---preprocessor"><span itemprop="name">Tutorial - Preprocessor</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Introduction</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Introduction</h1></header>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Overview</div><div class="admonitionContent_BuS1"><p>This document provides essential guidance for developers creating Preprocessor services within the Federated Open-Source Platform and Services (FOSPS) environment, particularly focusing on the annotation process for Electronic Product Information (ePI).</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-preprocessors">What Are Preprocessors?<a href="#what-are-preprocessors" class="hash-link" aria-label="Direct link to What Are Preprocessors?" title="Direct link to What Are Preprocessors?">​</a></h2>
<p>A <strong>preprocessor</strong> is a software service that annotates an ePI for further processing. Preprocessors are designed to be pluggable components that integrate seamlessly into the platform&#x27;s focusing workflow. They operate dynamically and can be configured as modules that the Focusing Manager automatically identifies and invokes when an ePI requires preprocessing.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="role-in-epi-annotation">Role in ePI Annotation<a href="#role-in-epi-annotation" class="hash-link" aria-label="Direct link to Role in ePI Annotation" title="Direct link to Role in ePI Annotation">​</a></h2>
<p>Preprocessors are tasked with performing <strong>semantic annotation</strong> on ePI content. This crucial process involves reading the ePI and automatically annotating parts of the narrative text. Specifically, preprocessors identify text sections containing information about any topic and semantically link them to clinical terminologies.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Goal of Semantic Annotation</div><div class="admonitionContent_BuS1"><p>The goal of semantic annotation is to transform the unstructured narrative text of the ePI into a structured representation, making the information easier to analyze, search, and understand for subsequent processes. These annotations typically consist of codes from standard terminologies, such as <strong>SNOMED-CT</strong> or <strong>ICPC-2</strong>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="role-in-the-focusing-mechanism">Role in the Focusing Mechanism<a href="#role-in-the-focusing-mechanism" class="hash-link" aria-label="Direct link to Role in the Focusing Mechanism" title="Direct link to Role in the Focusing Mechanism">​</a></h2>
<p>Preprocessing is the <strong>first step</strong> in the multi-stage focusing process. The focusing mechanism itself is defined as adapting information to the context of the end user for effective and optimal understanding of the information.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Preprocessing Workflow</div><div class="admonitionContent_BuS1"><p>The output of the preprocessing stage is the <strong>preprocessed ePI</strong>, or <strong>p(ePI)</strong>. The p(ePI) retains the original text content of the raw ePI but is enriched with metadata embedded within the text, matching text sections to for example clinical terminologies. This annotated ePI is then ready to be consumed by the Lenses, which contain the logic for personalization based on user context (like their IPS or preferences).</p></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Stacking Preprocessors</div><div class="admonitionContent_BuS1"><p>Preprocessors must be built with the understanding that they may be <strong>stacked</strong>, i.e., executed sequentially, with other preprocessors to generate a complete annotation of the ePI. The Focusing Manager coordinates this orchestration.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-use-of-standard-terminologies-eg-snomed-ct-icpc-2-for-annotation">Understanding the use of standard terminologies (e.g., SNOMED-CT, ICPC-2) for annotation<a href="#understanding-the-use-of-standard-terminologies-eg-snomed-ct-icpc-2-for-annotation" class="hash-link" aria-label="Direct link to Understanding the use of standard terminologies (e.g., SNOMED-CT, ICPC-2) for annotation" title="Direct link to Understanding the use of standard terminologies (e.g., SNOMED-CT, ICPC-2) for annotation">​</a></h2>
<p>Semantic annotation within the FOSPS relies on the principle of linking sections of the ePI narrative text to standard medical vocabularies, such as SNOMED-CT (Systematized Nomenclature of Medicine Clinical Terms) and ICPC-2 (International Classification of Primary Care version 2). The usage of these standard terminologies is essential to standardize clinical and medical nomenclature and definitions across the platform.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-of-the-htmlelementlink-extension">Use of the HtmlElementLink Extension<a href="#use-of-the-htmlelementlink-extension" class="hash-link" aria-label="Direct link to Use of the HtmlElementLink Extension" title="Direct link to Use of the HtmlElementLink Extension">​</a></h3>
<p>The mechanism used to link these standard terminology concepts (codes) to specific parts of the ePI narrative text relies on the <a href="https://build.fhir.org/ig/hl7-eu/gravitate-health/StructureDefinition-HtmlElementLink.html" target="_blank" rel="noopener noreferrer">HtmlElementLink FHIR extension</a>.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>About HtmlElementLink</div><div class="admonitionContent_BuS1"><p>The HtmlElementLink extension is complex and is utilized for adding information—which may be pictograms, images, video, or other flexible types of data—to ePIs in the FHIR format. It is typically applied to the Composition resource within the ePI Bundle.</p></div></div>
<p><strong>This extension contains sub-extensions to define the linkage:</strong></p>
<ol>
<li>
<p><strong><code>extension:concept</code></strong>: This mandatory component specifies the data to be used, which is generally a reference to a resource, a CodeableConcept (such as a SNOMED-CT or ICPC-2 code), a URL, or a string. This is the standard terminology code representing the clinical concept being annotated.</p>
</li>
<li>
<p><strong><code>extension:elementClass</code></strong>: This component, required for linking, specifies the location in the HTML to which the concept applies. This value is a string intended to be used as an HTML class attribute.</p>
</li>
</ol>
<p>By declaring the concept (code) and linking it to a specific <code>elementClass</code> using the HtmlElementLink extension, preprocessors enable the narrative text (which is contained within HTML) to feature class attributes that reference these defined concepts.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="preprocessor-execution">Preprocessor Execution<a href="#preprocessor-execution" class="hash-link" aria-label="Direct link to Preprocessor Execution" title="Direct link to Preprocessor Execution">​</a></h2>
<p>A Preprocessor is implemented as a <strong>containerized service module</strong> that is pluggable into FOSPS. This service must expose an endpoint (typically <code>/preprocess</code>) that receives the entire ePI resource in its body and responds with the preprocessed version, having performed the semantic annotation.</p>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Service Specification</div><div class="admonitionContent_BuS1"><p>The preprocessed response should maintain the original FHIR format of the input ePI, ensuring that no changes are made to the underlying data structure. This simple service is specified in <a href="https://raw.githubusercontent.com/Gravitate-Health/preprocessing-service-example/refs/heads/main/openapi.yaml" target="_blank" rel="noopener noreferrer">OpenAPI</a> for developer convenience.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="modularity-benefits">Modularity Benefits<a href="#modularity-benefits" class="hash-link" aria-label="Direct link to Modularity Benefits" title="Direct link to Modularity Benefits">​</a></h3>
<p>Preprocessors must be implemented as separate services, allowing them to be easily developed, tested, and maintained independently of the rest of the system. This modularity enables a wide range of preprocessing techniques to be integrated into FOSPS, making it possible to handle various use cases and requirements in different languages using different frameworks.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="service-discovery">Service Discovery<a href="#service-discovery" class="hash-link" aria-label="Direct link to Service Discovery" title="Direct link to Service Discovery">​</a></h3>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Docker Tag Requirement</div><div class="admonitionContent_BuS1"><p>To enable the focusing manager component to locate and orchestrate preprocessors, each preprocessor service should be launched with a specific tag:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">eu.gravitate-health.fosps.preprocessing=True</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This allows the focusing manager to identify available preprocessors and direct incoming ePI resources through the relevant preprocessing pipeline. The focusing manager will then forward the preprocessed output to the next stage of processing.</p></div></div>
<p>By following this design pattern, developers can easily create and integrate new preprocessing algorithms into FOSPS, enhancing its capabilities and flexibility in handling diverse healthcare data formats and use cases.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-requirements-for-preprocessor-html-modification">Technical Requirements for Preprocessor HTML Modification<a href="#technical-requirements-for-preprocessor-html-modification" class="hash-link" aria-label="Direct link to Technical Requirements for Preprocessor HTML Modification" title="Direct link to Technical Requirements for Preprocessor HTML Modification">​</a></h2>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Regulatory Compliance</div><div class="admonitionContent_BuS1"><p>When generating annotations, preprocessors must adhere to strict constraints regarding HTML modifications to ensure regulatory compliance and proper functioning within the Focusing Mechanism.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="modification-rules">Modification Rules<a href="#modification-rules" class="hash-link" aria-label="Direct link to Modification Rules" title="Direct link to Modification Rules">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-modification-limits-no-content-editing">1. Modification Limits (<strong>No Content Editing</strong>)<a href="#1-modification-limits-no-content-editing" class="hash-link" aria-label="Direct link to 1-modification-limits-no-content-editing" title="Direct link to 1-modification-limits-no-content-editing">​</a></h4>
<p>The content of the ePI is highly regulated and must be preserved exactly as approved. Preprocessors must not remove any content or change the narrative content of the original ePI.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Edits are strictly limited to technical modifications of the HTML structure</div><div class="admonitionContent_BuS1"><ul>
<li>Adding HTML class attributes</li>
<li>Adding new HTML tags for the purpose of supplementary information or delineation</li>
</ul></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-adding-classes-to-existing-tags">2. Adding Classes to Existing Tags<a href="#2-adding-classes-to-existing-tags" class="hash-link" aria-label="Direct link to 2. Adding Classes to Existing Tags" title="Direct link to 2. Adding Classes to Existing Tags">​</a></h4>
<p>Preprocessors should utilize HTML markup language to target text portions. Annotations are commonly applied by adding classes to existing HTML tags, such as:</p>
<ul>
<li>Header tags: <code>&lt;h1&gt;</code>, <code>&lt;h2&gt;</code>, etc.</li>
<li>List items: <code>&lt;ul&gt;</code>, <code>&lt;li&gt;</code></li>
<li>Paragraphs: <code>&lt;p&gt;</code></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-generating-invisible-tags">3. Generating Invisible Tags<a href="#3-generating-invisible-tags" class="hash-link" aria-label="Direct link to 3. Generating Invisible Tags" title="Direct link to 3. Generating Invisible Tags">​</a></h4>
<p>To mark arbitrary text segments for annotation without affecting the display style, preprocessors may use non-style-changing tags.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Recommended Tag</div><div class="admonitionContent_BuS1"><p>The preferred tag for selecting arbitrary text is the <code>&lt;span&gt;</code> tag.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-stacking-awareness">4. Stacking Awareness<a href="#4-stacking-awareness" class="hash-link" aria-label="Direct link to 4. Stacking Awareness" title="Direct link to 4. Stacking Awareness">​</a></h4>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Preprocessor Stacking</div><div class="admonitionContent_BuS1"><p>Since preprocessors can be stacked (a preprocessor&#x27;s input may be the output of one or more previous preprocessors), developers should implement logic that checks for existing attributes and handles their concatenation to maintain a clean and effective structure.</p></div></div>
<p><strong>Key considerations:</strong></p>
<ul>
<li>
<p><strong>Duplicate prevention</strong>: Avoid adding duplicates like <code>extension:concept</code>, or <code>extension:elementClass</code> with the same values</p>
</li>
<li>
<p><strong>Avoiding HTML Nesting</strong>: Developers must be aware that when applying annotations, they should avoid creating redundant or complex HTML structures. If a target HTML element already has a class attribute (potentially added by a preceding preprocessor), the new class attribute referencing the terminology concept should be added to the existing class attributes, rather than wrapping the element in a new, nested tag.</p>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/gravitate-health/gravitate-health.github.io/tree/main/docs/tutorial-Preprocessor/0 - Introduction.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/tutorial---preprocessor"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tutorial - Preprocessor</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/tutorial-Preprocessor/Develop a Basic Preprocessor"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Develop a Basic Preprocessor</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-are-preprocessors" class="table-of-contents__link toc-highlight">What Are Preprocessors?</a></li><li><a href="#role-in-epi-annotation" class="table-of-contents__link toc-highlight">Role in ePI Annotation</a></li><li><a href="#role-in-the-focusing-mechanism" class="table-of-contents__link toc-highlight">Role in the Focusing Mechanism</a></li><li><a href="#understanding-the-use-of-standard-terminologies-eg-snomed-ct-icpc-2-for-annotation" class="table-of-contents__link toc-highlight">Understanding the use of standard terminologies (e.g., SNOMED-CT, ICPC-2) for annotation</a><ul><li><a href="#use-of-the-htmlelementlink-extension" class="table-of-contents__link toc-highlight">Use of the HtmlElementLink Extension</a></li></ul></li><li><a href="#preprocessor-execution" class="table-of-contents__link toc-highlight">Preprocessor Execution</a><ul><li><a href="#modularity-benefits" class="table-of-contents__link toc-highlight">Modularity Benefits</a></li><li><a href="#service-discovery" class="table-of-contents__link toc-highlight">Service Discovery</a></li></ul></li><li><a href="#technical-requirements-for-preprocessor-html-modification" class="table-of-contents__link toc-highlight">Technical Requirements for Preprocessor HTML Modification</a><ul><li><a href="#modification-rules" class="table-of-contents__link toc-highlight">Modification Rules</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" href="/reference/intro">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://x.com/gravitatehealth" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/gravitatehealth" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/graviate-heath" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Gravitate Health, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>